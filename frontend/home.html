<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Entrepreneur Tunisie - Plateforme des Auto-Entrepreneurs</title>
    <meta name="description" content="La premi√®re plateforme tunisienne d√©di√©e aux auto-entrepreneurs. Trouvez des services de qualit√© ou proposez vos comp√©tences.">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/homepage.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <h2 class="logo-text">üáπüá≥ Auto-Entrepreneur</h2>
                </div>
                <div class="nav-links">
                    <a href="services.html" class="nav-link">Services</a>
                    <a href="#autoentrepreneurs" class="nav-link">Auto-entrepreneurs</a>
                    <a href="#about" class="nav-link">√Ä propos</a>
                    <div class="auth-buttons">
                        <a href="login.html" class="btn btn-secondary">Connexion</a>
                        <a href="register.html" class="btn btn-primary">Inscription</a>
                    </div>
                </div>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        Connectez-vous avec les meilleurs 
                        <span class="text-gradient">auto-entrepreneurs tunisiens</span>
                    </h1>
                    <p class="hero-description">
                        D√©couvrez des services de qualit√© ou proposez vos comp√©tences sur la premi√®re plateforme 
                        d√©di√©e aux auto-entrepreneurs en Tunisie.
                    </p>
                    <div class="hero-actions">
                        <a href="services.html" class="btn btn-primary btn-lg">
                            üîç Trouver un service
                        </a>
                        <a href="register.html" class="btn btn-outline btn-lg">
                            üíº Devenir auto-entrepreneur
                        </a>
                    </div>
                    <div class="hero-stats">
                        <div class="stat">
                            <span class="stat-number" id="totalServices">50+</span>
                            <span class="stat-label">Services disponibles</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="totalAutoentrepreneurs">25+</span>
                            <span class="stat-label">Auto-entrepreneurs</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">4.9</span>
                            <span class="stat-label">Note moyenne</span>
                        </div>
                    </div>
                </div>
                <div class="hero-image">
                    <div class="hero-card">
                        <div class="card-header">
                            <div class="avatar">AB</div>
                            <div class="card-info">
                                <h4>Ahmed Ben Ali</h4>
                                <p>D√©veloppeur Web</p>
                            </div>
                        </div>
                        <div class="card-content">
                            <h5>Cr√©ation de site web professionnel</h5>
                            <div class="card-rating">
                                ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê <span>5.0 (24 avis)</span>
                            </div>
                            <div class="card-price">√Ä partir de 500 DT</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories" id="services">
        <div class="container">
            <div class="section-header">
                <h2>Explorez nos cat√©gories</h2>
                <p>Trouvez le service parfait pour votre projet</p>
            </div>
            <div class="categories-grid">
                <a href="services.html?category=D√©veloppement" class="category-card">
                    <div class="category-icon">üíª</div>
                    <h3>D√©veloppement Web</h3>
                    <p>Sites web, applications, e-commerce</p>
                </a>
                <a href="services.html?category=Graphisme" class="category-card">
                    <div class="category-icon">üé®</div>
                    <h3>Design Graphique</h3>
                    <p>Logo, branding, design visuel</p>
                </a>
                <a href="services.html?category=Marketing" class="category-card">
                    <div class="category-icon">üìà</div>
                    <h3>Marketing Digital</h3>
                    <p>SEO, r√©seaux sociaux, publicit√©</p>
                </a>
                <a href="services.html?category=R√©daction" class="category-card">
                    <div class="category-icon">‚úçÔ∏è</div>
                    <h3>R√©daction</h3>
                    <p>Articles, contenu, copywriting</p>
                </a>
                <a href="services.html?category=Traduction" class="category-card">
                    <div class="category-icon">üåê</div>
                    <h3>Traduction</h3>
                    <p>Services de traduction professionnelle</p>
                </a>
                <a href="services.html?category=Vid√©o" class="category-card">
                    <div class="category-icon">üé¨</div>
                    <h3>Vid√©o & Animation</h3>
                    <p>Montage vid√©o, motion design</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Featured Services -->
    <section class="featured-services">
        <div class="container">
            <div class="section-header">
                <h2>Services en vedette</h2>
                <p>D√©couvrez les services les plus populaires</p>
            </div>
            <div class="services-grid" id="featuredServices">
                <!-- Loading state -->
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>Chargement des services...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Top Auto-entrepreneurs -->
    <section class="top-autoentrepreneurs" id="autoentrepreneurs">
        <div class="container">
            <div class="section-header">
                <h2>Auto-entrepreneurs recommand√©s</h2>
                <p>D√©couvrez les professionnels les mieux not√©s</p>
            </div>
            <div class="autoentrepreneurs-grid" id="topAutoentrepreneurs">
                <!-- Loading state -->
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>Chargement des auto-entrepreneurs...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How it works -->
    <section class="how-it-works" id="about">
        <div class="container">
            <div class="section-header">
                <h2>Comment √ßa marche ?</h2>
                <p>Trois √©tapes simples pour commencer</p>
            </div>
            <div class="steps-grid">
                <div class="step">
                    <div class="step-icon">üîç</div>
                    <h3>1. Recherchez</h3>
                    <p>Parcourez les services ou auto-entrepreneurs selon vos besoins</p>
                </div>
                <div class="step">
                    <div class="step-icon">üí¨</div>
                    <h3>2. Contactez</h3>
                    <p>Discutez directement avec l'auto-entrepreneur pour d√©finir votre projet</p>
                </div>
                <div class="step">
                    <div class="step-icon">‚úÖ</div>
                    <h3>3. R√©alisez</h3>
                    <p>Recevez votre service de qualit√© et laissez un avis</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta">
        <div class="container">
            <div class="cta-content">
                <h2>Pr√™t √† commencer ?</h2>
                <p>Rejoignez des milliers d'auto-entrepreneurs et clients satisfaits</p>
                <div class="cta-buttons">
                    <a href="register.html" class="btn btn-primary btn-lg">
                        Trouver un service
                    </a>
                    <a href="register.html" class="btn btn-outline btn-lg">
                        Proposer mes services
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>üáπüá≥ Auto-Entrepreneur Tunisie</h3>
                    <p>La plateforme qui connecte les auto-entrepreneurs tunisiens avec leurs clients.</p>
                </div>
                <div class="footer-section">
                    <h4>Liens rapides</h4>
                    <ul>
                        <li><a href="services.html">Services</a></li>
                        <li><a href="login.html">Connexion</a></li>
                        <li><a href="register.html">Inscription</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="#">Centre d'aide</a></li>
                        <li><a href="#">Conditions d'utilisation</a></li>
                        <li><a href="#">Politique de confidentialit√©</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul>
                        <li>üìß contact@autoentrepreneur-tn.com</li>
                        <li>üì± +216 XX XXX XXX</li>
                        <li>üìç Tunis, Tunisie</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Auto-Entrepreneur Tunisie. Tous droits r√©serv√©s.</p>
            </div>
        </div>
    </footer>

    <script>
        function toggleMobileMenu() {
            const nav = document.querySelector('.nav-links');
            nav.classList.toggle('active');
        }

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Optimized scroll effect for header
        let ticking = false;
        function updateHeader() {
            const header = document.querySelector('.header');
            if (window.scrollY > 100) {
                header.style.backgroundColor = 'rgba(255, 255, 255, 0.98)';
            } else {
                header.style.backgroundColor = 'rgba(255, 255, 255, 0.95)';
            }
            ticking = false;
        }

        window.addEventListener('scroll', function() {
            if (!ticking) {
                requestAnimationFrame(updateHeader);
                ticking = true;
            }
        });

        // Simplified scroll animations
        const observerOptions = {
            threshold: 0.2,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-in');
                    observer.unobserve(entry.target); // Stop observing once animated
                }
            });
        }, observerOptions);

        // Load real data from API
        async function loadServices() {
            try {
                const response = await fetch('http://localhost:8000/backend/index.php?route=api/services');
                const data = await response.json();

                console.log('Services API response:', data); // Debug log

                if (data.success && data.data && Array.isArray(data.data)) {
                    displayServices(data.data);
                    updateStats(data.data.length);
                } else {
                    console.error('Invalid services data format:', data);
                    showServicesError('Format de donn√©es invalide');
                }
            } catch (error) {
                console.error('Error loading services:', error);
                showServicesError('Impossible de charger les services: ' + error.message);
            }
        }

        async function loadAutoentrepreneurs() {
            try {
                const response = await fetch('http://localhost:8000/backend/index.php?route=api/autoentrepreneurs');
                const data = await response.json();

                if (data.success && data.data && Array.isArray(data.data)) {
                    displayAutoentrepreneurs(data.data);
                    // Update stats with auto-entrepreneurs count
                    const totalServicesEl = document.getElementById('totalServices');
                    const servicesCount = totalServicesEl ? parseInt(totalServicesEl.textContent) : 0;
                    updateStats(servicesCount, data.data.length);
                } else {
                    console.error('Invalid auto-entrepreneurs data format:', data);
                    showAutoentrepreneursError('Format de donn√©es invalide');
                }
            } catch (error) {
                console.error('Error loading auto-entrepreneurs:', error);
                showAutoentrepreneursError('Impossible de charger les auto-entrepreneurs: ' + error.message);
            }
        }

        function displayServices(services) {
            const container = document.getElementById('featuredServices');

            if (!services || services.length === 0) {
                container.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">üì≠</div>
                        <h3>Aucun service disponible</h3>
                        <p>Les services seront bient√¥t disponibles</p>
                    </div>
                `;
                return;
            }

            // Take first 3 services for featured section
            const featuredServices = services.slice(0, 3);

            container.innerHTML = featuredServices.map((service, index) => {
                const colors = ['0ea5e9', '8b5cf6', 'f59e0b'];
                const color = colors[index % colors.length];

                // Handle images - check if it's a string that needs to be split
                let imageUrl;
                if (service.images && typeof service.images === 'string' && service.images.trim() !== '') {
                    const imageList = service.images.split(',').map(img => img.trim()).filter(img => img);
                    imageUrl = imageList.length > 0 ? imageList[0] : null;
                }

                // Use placeholder if no valid image
                if (!imageUrl || imageUrl === 'img1.jpg' || imageUrl === 'aa') {
                    imageUrl = `https://via.placeholder.com/350x220/${color}/ffffff?text=${encodeURIComponent(service.title.substring(0, 15))}`;
                }

                return `
                    <div class="service-card">
                        <div class="service-image">
                            <img src="${imageUrl}" alt="${service.title}" onerror="this.src='https://via.placeholder.com/350x220/${color}/ffffff?text=Service'">
                        </div>
                        <div class="service-content">
                            <h3>${service.title}</h3>
                            <p>${service.description.substring(0, 100)}${service.description.length > 100 ? '...' : ''}</p>
                            <div class="service-meta">
                                <div class="service-rating">‚≠ê ${service.rating || '5.0'} (${service.reviews_count || Math.floor(Math.random() * 20) + 5})</div>
                                <div class="service-price">${parseFloat(service.price).toFixed(0)} DT</div>
                            </div>
                            <a href="service.html?id=${service.id}" class="btn btn-primary">Voir d√©tails</a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function displayAutoentrepreneurs(autoentrepreneurs) {
            const container = document.getElementById('topAutoentrepreneurs');

            if (autoentrepreneurs.length === 0) {
                container.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">üë•</div>
                        <h3>Aucun auto-entrepreneur disponible</h3>
                        <p>Les auto-entrepreneurs seront bient√¥t disponibles</p>
                    </div>
                `;
                return;
            }

            // Take first 3 auto-entrepreneurs
            const featuredAE = autoentrepreneurs.slice(0, 3);

            container.innerHTML = featuredAE.map((ae, index) => {
                const avatarUrl = ae.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(ae.name)}&background=0ea5e9&color=fff&size=100`;
                const location = ae.location || 'Tunisie';
                const bio = ae.bio || 'Auto-entrepreneur professionnel';
                const categories = ae.categories || 'Services divers';

                return `
                    <div class="autoentrepreneur-card">
                        <div class="ae-avatar">
                            <img src="${avatarUrl}" alt="${ae.name}" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(ae.name)}&background=0ea5e9&color=fff&size=100'">
                        </div>
                        <div class="ae-info">
                            <h3>${ae.name}</h3>
                            <p>${categories}</p>
                            <div class="ae-location">üìç ${location}</div>
                            <div class="ae-rating">‚≠ê ${ae.rating || '5.0'}</div>
                            <div class="ae-services">${ae.services_count || Math.floor(Math.random() * 10) + 1} services</div>
                            <a href="profile.html?id=${ae.id}" class="btn btn-primary">Voir profil</a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showServicesError(message) {
            const container = document.getElementById('featuredServices');
            container.innerHTML = `
                <div class="error-state">
                    <div class="error-icon">üòû</div>
                    <h3>Erreur de chargement</h3>
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="loadServices()">R√©essayer</button>
                </div>
            `;
        }

        function showAutoentrepreneursError(message) {
            const container = document.getElementById('topAutoentrepreneurs');
            container.innerHTML = `
                <div class="error-state">
                    <div class="error-icon">üòû</div>
                    <h3>Erreur de chargement</h3>
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="loadAutoentrepreneurs()">R√©essayer</button>
                </div>
            `;
        }

        function updateStats(servicesCount) {
            const totalServicesEl = document.getElementById('totalServices');
            const totalAutoentrepreneursEl = document.getElementById('totalAutoentrepreneurs');

            if (totalServicesEl) {
                totalServicesEl.textContent = servicesCount + '+';
            }

            // Load auto-entrepreneurs count
            fetch('http://localhost:8000/backend/index.php?route=api/autoentrepreneurs')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.data && totalAutoentrepreneursEl) {
                        totalAutoentrepreneursEl.textContent = data.data.length + '+';
                    }
                })
                .catch(error => console.error('Error loading auto-entrepreneurs:', error));
        }

        function displayAutoentrepreneurs(autoentrepreneurs) {
            const container = document.getElementById('topAutoentrepreneurs');

            if (!autoentrepreneurs || autoentrepreneurs.length === 0) {
                container.innerHTML = `
                    <div class="error-state">
                        <div class="error-icon">üë•</div>
                        <h3>Aucun auto-entrepreneur disponible</h3>
                        <p>Les auto-entrepreneurs seront bient√¥t disponibles</p>
                    </div>
                `;
                return;
            }

            // Take first 3 auto-entrepreneurs
            const featuredAE = autoentrepreneurs.slice(0, 3);

            container.innerHTML = featuredAE.map((ae, index) => {
                const avatarUrl = ae.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(ae.name)}&background=0ea5e9&color=fff&size=100`;
                const location = ae.location || 'Tunisie';
                const bio = ae.bio || 'Auto-entrepreneur professionnel';
                const categories = ae.categories || 'Services divers';

                return `
                    <div class="autoentrepreneur-card">
                        <div class="ae-avatar">
                            <img src="${avatarUrl}" alt="${ae.name}" onerror="this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(ae.name)}&background=0ea5e9&color=fff&size=100'">
                        </div>
                        <div class="ae-info">
                            <h3>${ae.name}</h3>
                            <p>${categories}</p>
                            <div class="ae-location">üìç ${location}</div>
                            <div class="ae-rating">‚≠ê ${ae.rating || '5.0'}</div>
                            <div class="ae-services">${ae.services_count || Math.floor(Math.random() * 10) + 1} services</div>
                            <a href="profile.html?id=${ae.id}" class="btn btn-primary">Voir profil</a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showServicesError(message) {
            const container = document.getElementById('featuredServices');
            container.innerHTML = `
                <div class="error-state">
                    <div class="error-icon">üòû</div>
                    <h3>Erreur de chargement</h3>
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="loadServices()">R√©essayer</button>
                </div>
            `;
        }

        function showAutoentrepreneursError(message) {
            const container = document.getElementById('topAutoentrepreneurs');
            container.innerHTML = `
                <div class="error-state">
                    <div class="error-icon">üòû</div>
                    <h3>Erreur de chargement</h3>
                    <p>${message}</p>
                    <button class="btn btn-primary" onclick="loadAutoentrepreneurs()">R√©essayer</button>
                </div>
            `;
        }

        function updateStats(servicesCount, autoentrepreneursCount = null) {
            const totalServicesEl = document.getElementById('totalServices');
            const totalAutoentrepreneursEl = document.getElementById('totalAutoentrepreneurs');

            if (totalServicesEl) {
                totalServicesEl.textContent = servicesCount + '+';
            }

            if (autoentrepreneursCount && totalAutoentrepreneursEl) {
                totalAutoentrepreneursEl.textContent = autoentrepreneursCount + '+';
            }
        }

        // Optimized page initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Load real data
            loadServices();
            loadAutoentrepreneurs();

            // Simplified animations
            const animatedElements = document.querySelectorAll('.category-card, .service-card, .step, .section-header');
            animatedElements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                observer.observe(el);
            });

            // Simple stats counter (no animation)
            setTimeout(() => {
                const stats = document.querySelectorAll('.stat-number');
                stats.forEach(stat => {
                    const finalValue = stat.textContent;
                    if (finalValue.includes('+')) {
                        // Just set the final value without animation
                        stat.textContent = finalValue;
                    }
                });
            }, 1000);
        });

        // Removed parallax effect for better performance
    </script>
</body>
</html>
